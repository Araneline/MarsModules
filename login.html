<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<link rel="stylesheet" type="text/css" href="style.css">
<title>Экран погоды на Марсе</title>
</head>
<body>
<div class="container bordered-item">
<div style="padding-top: 36.4vh; padding-left: 7.4vw;">
<p class="nomargin" style="font-size: 2.1vw; font-family: EuropeExt; margin-bottom: 27px; letter-spacing: normal;">ПРОВЕРКА ID:</p>
<div style="display: flex; align-items: center; justify-content: flex-start;">
<div class="outer_border"><input id="inputID" class="button" placeholder="Введите ID" autofocus type="password" style="color: transparent"></div>
<div id="message_div"></div>
</div>
<p class="info_text nomargin">Для входа в панель терминала используйте персональную ID-карту.</p>
<p class="info_text nomargin">Использование терминала под чужим ID строго запрещено.</p>
<p class="info_text nomargin" style="margin-bottom: 7.7vh;">Все действия и операции на данном терминале будут сохранены.</p>
<div id="console_container">
<div><span id="first_string" class="consoletext nomargin"></span></div>
</div>
</div>
</div>
</body>
</html>

<style>
.line {
    display: inline-block;
    font-family: PFDinTextPro-Regular;
}
.message {
    padding-right: 1vw;
}
.error {
  animation-name: blink_anim; 
  animation-duration: 1s; 
  animation-iteration-count: infinite;
  transition-timing-function: linear;
  -webkit-animation-name: blink_anim; 
  -webkit-animation-duration: 1s; 
  -webkit-animation-iteration-count: infinite;
  -webkit-transition-timing-function: linear;
}

@keyframes blink_anim {
  0% { 
    opacity: 1; 
  }
  50% {
    opacity: 0;
  }
}
#message_div {
    font-size: 1.4vw;   
    font-family: EuropeExt;
    margin-bottom: 7.5vh;
    /* color: rgb(121,183,0); */
    color: rgb(176,146,97);
    padding-left: 2.2vw;
}
.outer_border {
	border: #c3f6fa 2px solid;
	padding: 10px;
	display: flex;
	width: 19.5vw;
    height: 9.5vh; 
    margin-bottom: 7.5vh;
    transition: all 0.5s linear;
}
.button {
    border: rgb(0,98,125) 2px solid;
    width: 100%;
    flex: 1;
    background: transparent;
    color: rgb(195,246,249);
    text-align: center;
    text-decoration: none;
    display: inline-block;
}
.button::-webkit-input-placeholder { /* Chrome/Opera/Safari */
  color: rgb(176,146,97);
}
.consoletext {
    font-family: PFDinTextPro-Regular;
  	color: rgb(0,98,125);
	text-transform: none;
	letter-spacing: normal;
	font-size: 1.2vw;
    white-space:pre;
    animation: type 8s steps(60, end);
    white-space: pre;
    overflow: hidden;
    width: 100%;
}
.info_text {
	text-transform: none;
    font-size: 1.78vw;
    letter-spacing: 0.05em;
	font-family: PFDinTextPro-Regular;
    line-height: 4vh;
}
input {
    font-size: 1.5vw;	
    font-family: EuropeExt;
}
#console_container {
    height: 75px;
    overflow: auto;
}
::-webkit-scrollbar { 
    display: none; 
}
</style>

<script src="lib/typed.min.js" type="text/javascript"></script>
<script src="assets/demos.js"></script>
<script src="jquery.min.js"></script>

<script type="text/javascript">
    var start = performance.now();
    var line_state = 0;
    var prevTime = 0;

    function rotate_line(time){
      var timePassed = time - start;
      if ((timePassed - prevTime) > 200) {
        switch(line_state) {
            case 0:
                $('.line').css({'transform' : 'rotate(0deg)'});
                line_state = 1;
                break;
            case 1:
                $('.line').css({'transform' : 'rotate(45deg)'});
                line_state = 2;
                break;
            case 2:
                $('.line').css({'transform' : 'rotate(90deg)'});
                line_state = 3;
                break;
            case 3:
                $('.line').css({'transform' : 'rotate(135deg)'});
                line_state = 0;
                break;
        }
        prevTime = timePassed;
        requestAnimationFrame(rotate_line);
      } else {
        requestAnimationFrame(rotate_line);
      }

    };
    requestAnimationFrame(rotate_line);


    $('#inputID').keyup(function() {
        if($('#inputID').val().length > 0) {
            $('#inputID').css('color','rgb(176,146,97)');
        } else {
            $('#inputID').css('color','transparent');
        }
    });

    $('#inputID').change(function() {
            checkAuth($('#inputID').val().split("").reverse().join(""));
    });    

    function checkAuth(code) {
        var typed2 = new Typed("#message_div", {strings: ["<span class=\"message\">ПРОВЕРКА</span><span class=\"line\">&boxh;</span>"], typeSpeed: speedType});

        $('#console_container').append("<div><span id=\"a_string\" class=\"consoletext nomargin\"></span></div>");
        var typed2 = new Typed("#a_string", {strings: ["// Подключение юзера " + code], typeSpeed: speedType});

        $('#console_container').append("<div><span id=\"b_string\" class=\"consoletext nomargin\"></span><span id=\"e_string\" class=\"consoletext nomargin\"></span></div>");
        var typed2 = new Typed("#b_string", {strings: ["// Ждём подключения "], startDelay: 1500, typeSpeed: speedType, preStringTyped: function(self) {$('#console_container').animate({scrollTop: $('#console_container').prop('scrollHeight')}, 500);}});
        var typed2 = new Typed("#e_string", {strings: ["......"], startDelay: 2000, typeSpeed: 500, onComplete: function(self) {errorAuth()}});

        
    };

    function errorAuth() {
        $('#message_div').children().eq(0).remove();
        $('#message_div').children().eq(0).remove();
        $('.outer_border').css('background','rgb(100,0,3)');
        var typed2 = new Typed("#message_div", {strings: ["<span class=\"message error\">ОШИБКА</span>"], typeSpeed: speedType});
        $('#console_container').append("<div><span id=\"c_string\" class=\"consoletext nomargin\"></span></div>");
        var typed2 = new Typed("#c_string", {strings: ["// Ошибка аутентификации."], startDelay: 500, typeSpeed: speedType, preStringTyped: function(self) {$('#console_container').animate({scrollTop: $('#console_container').prop('scrollHeight')}, 500);}});
    }

    function updateScroll() {
        var element = document.getElementById("console_container");
        element.scrollTop = element.scrollHeight;
    };

    var fontSize = $('#first_string').css('font-size');
    var lineHeight = Math.floor(parseInt(fontSize.replace('px','')) * 1.3);
    const speedType = -150;


    $('#console_container').css('height', lineHeight * 3);

    var typed = new Typed("#first_string", {strings: ["// MarsOS v1.27"], typeSpeed: speedType});

    $('#console_container').append("<div><span id=\"second_string\" class=\"consoletext nomargin\"></span></div>");
    var typed2 = new Typed("#second_string", {strings: ["// Защищенное соединение  : Mars Secure Logon"], startDelay: 1500, typeSpeed: speedType});
        
    //$('#console_container').append("<div><span id=\"third_string\" class=\"consoletext nomargin\"></span></div>");
    //var typed2 = new Typed("#third_string", {strings: ["// Защищенное соединение  : Mars Secure Logon"], startDelay: 5000, typeSpeed: 50, preStringTyped: function(self) {$('#console_container').animate({scrollTop: $('#console_container').prop('scrollHeight')}, 500);}});
    
    
    
</script>